IDENTIFICATION DIVISION. 
PROGRAM-ID. RESTAURANTE. 
DATA DIVISION. 
WORKING-STORAGE SECTION. 
01 WS-COMANDO-SQL PIC X(100). 
01 WS-ERROR-SQL PIC X(100). 
01 WS-NOMBRE-CLIENTE PIC X(50). 
01 WS-TELEFONO-CLIENTE PIC X(15). 
01 WS-DIRECCION-CLIENTE PIC X(50). 
01 WS-NUMERO-MESA PIC 9(2). 
01 WS-CAPACIDAD-MESA PIC 9(2). 
01 WS-CANTIDAD-PLATILLOS PIC 9(2). 
01 WS-TOTAL-FACTURA PIC 9(6)V99. 
01 WS-NOMBRE-PLATILLO PIC X(50). 
01 WS-DESCRIPCION-PLATILLO PIC X(255). 
01 WS-PRECIO-PLATILLO PIC 9(5)V99. 
01 OPCION PIC 9. 
01 TIPO-PLATO-SELECCIONADO PIC 9. 
01 WS-CATEGORIA-PLATILLO PIC X(20). 
01 WS-ERROR PIC X(100).
PROCEDURE DIVISION. 
MAIN-PROGRAM. 
DISPLAY "BIENVENIDO AL PROGRAMA DEL RESTAURANTE". 
DISPLAY "----------------------------------------". PERFORM MENU-OPTIONS UNTIL OPCION = 5. STOP RUN.
MENU-OPTIONS. 
DISPLAY "SELECCIONE UNA OPCIÓN:". 
DISPLAY "1. AGREGAR CLIENTE". 
DISPLAY "2. AGREGAR MESA". 
DISPLAY "3. AGREGAR EXEC SQL PREPARE STMT FROM :WS-COMANDO-SQL 
END-EXEC 
EXEC SQL EXECUTE STMT END-EXEC IF SQLCODE NOT = 0 DISPLAY "ERROR: NO SE PUDO AGREGAR EL CLIENTE" DISPLAY "------------------------------------" DISPLAY WS-ERROR-SQL PERFORM MENU-OPTIONS END-IF DISPLAY "CLIENTE AGREGADO CON ÉXITO" DISPLAY "---------------------------" PERFORM MENU-OPTIONS.
ADD-MESA. DISPLAY "AGREGAR MESA". DISPLAY "--------------". DISPLAY "NÚMERO DE MESA: ". ACCEPT WS-NUMERO-MESA. DISPLAY "CAPACIDAD DE LA MESA: ". ACCEPT WS-CAPACIDAD-MESA. STRING "INSERT INTO MESAS (numero, capacidad) VALUES (", WS-NUMERO-MESA, ", ", WS-CAPACIDAD-MESA, ")" INTO WS-COMANDO-SQL. EXEC SQL CONNECT TO MYSQLDB END-EXEC EXEC SQL EXECUTE IMMEDIATE :WS-COMANDO-SQL END-EXEC IF SQLCODE NOT = 0 DISPLAY "ERROR: NO SE PUDO AGREGAR LA MESA" DISPLAY "--------------------------------" DISPLAY WS-ERROR-SQL PERFORM MENU-OPTIONS END-IF DISPLAY "MESA AGREGADA CON ÉXITO" DISPLAY "-----------------------" PERFORM MENU-OPTIONS.
ADD-PEDIDO. DISPLAY "AGREGAR PEDIDO". DISPLAY "----------------". DISPLAY "NÚMERO DE MESA: ". ACCEPT WS-NUMERO-MESA. DISPLAY "NOMBRE DEL CLIENTE: ". ACCEPT WS-NOMBRE-CLIENTE. DISPLAY "CANTIDAD DE PLATILLOS: ". ACCEPT WS-CANTIDAD-PLATILLOS. COMPUTE WS-TOTAL-FACTURA = 0 PERFORM AGREGAR-PLATILLO-AL-PEDIDO UNTIL WS-CANTIDAD-PLATILLOS = 0 STRING "INSERT INTO PEDIDOS (mesa, cliente, total) VALUES (", WS-NUMERO-MESA, ", '", WS-NOMBRE-CLIENTE, "', ", WS-TOTAL-FACTURA, ")" INTO WS-COMANDO-SQL. EXEC SQL CONNECT TO MYSQLDB END-EXEC EXEC SQL EXECUTE IMMEDIATE :WS-COMANDO-SQL END-EXEC IF SQLCODE NOT = 0 DISPLAY "ERROR: NO SE PUDO AGREGAR EL PEDIDO" DISPLAY "----------------------------------" DISPLAY WS-ERROR-SQL PERFORM MENU-OPTIONS END-IF DISPLAY "PEDIDO AGREGADO CON ÉXITO" DISPLAY "--------------------------" PERFORM MENU-OPTIONS.
AGREGAR-PLATO. DISPLAY "AGREGAR PLATO". DISPLAY "-------------". DISPLAY "CATEGORÍA DEL PLATO: " DISPLAY "1. DESAYUNOS" DISPLAY "2. ENTRADAS" DISPLAY "3. ENSALADAS" DISPLAY "4. CONTORNOS" DISPLAY "5. CARNES" DISPLAY "6. PESCADOS Y MARISCOS" DISPLAY "7. BEBIDAS" ACCEPT WS-CATEGORIA-PLATILLO DISPLAY "NOMBRE DEL PLATO: " ACCEPT WS-NOMBRE-PLATILLOPEDIDO". DISPLAY "4. ADMINISTRAR PLATOS". DISPLAY "5. SALIR". ACCEPT OPCION. IF OPCION = 1 PERFORM ADD-CLIENTE ELSE IF OPCION = 2 PERFORM ADD-MESA ELSE IF OPCION = 3 PERFORM ADD-PEDIDO ELSE IF OPCION = 4 PERFORM MENU-PLATOS.
MENU-PLATOS. DISPLAY "SELECCIONE UNA OPCIÓN:". DISPLAY "1. AGREGAR PLATO". DISPLAY "2. ELIMINAR PLATO". DISPLAY "3. MODIFICAR PLATO". DISPLAY "4. VER MENÚ". DISPLAY "5. VOLVER". ACCEPT OPCION. IF OPCION = 1 PERFORM ADD-PLATO ELSE IF OPCION = 2 PERFORM DELETE-PLATO ELSE IF OPCION = 3 PERFORM UPDATE-PLATO ELSE IF OPCION = 4 PERFORM VER-MENU.
ADD-CLIENTE. DISPLAY "AGREGAR CLIENTE". DISPLAY "--------------". DISPLAY "NOMBRE DEL CLIENTE: ". ACCEPT WS-NOMBRE-CLIENTE. DISPLAY "TELÉFONO DEL CLIENTE: ". ACCEPT WS-TELEFONO-CLIENTE. DISPLAY "DIRECCIÓN DEL CLIENTE: ". ACCEPT WS-DIRECCION-CLIENTE. STRING "INSERT INTO CLIENTES (nombre, telefono, direccion) VALUES ('", WS-NOMBRE-CLIENTE, "', '", WS-TELEFONO-CLIENTE, "', '", WS-DIRECCION-CLIENTE, "')" INTO WS-COMANDO-SQL. 
EXEC SQL PREPARE STMT FROM :WS-COMANDO-SQL END-EXEC EXEC SQL EXECUTE STMT END-EXEC IF SQLCODE NOT = 0 DISPLAY "ERROR: NO SE PUDO AGREGAR EL CLIENTE" DISPLAY "------------------------------------" DISPLAY WS-ERROR-SQL PERFORM MENU-OPTIONS END-IF DISPLAY "CLIENTE AGREGADO CON ÉXITO" DISPLAY "---------------------------" PERFORM MENU-OPTIONS.
ADD-MESA. DISPLAY "AGREGAR MESA". DISPLAY "--------------". DISPLAY "NÚMERO DE MESA: ". ACCEPT WS-NUMERO-MESA. DISPLAY "CAPACIDAD DE LA MESA: ". ACCEPT WS-CAPACIDAD-MESA. STRING "INSERT INTO MESAS (numero, capacidad) VALUES (", WS-NUMERO-MESA, ", ", WS-CAPACIDAD-MESA, ")" INTO WS-COMANDO-SQL. EXEC SQL CONNECT TO MYSQLDB END-EXEC EXEC SQL EXECUTE IMMEDIATE :WS-COMANDO-SQL END-EXEC IF SQLCODE NOT = 0 DISPLAY "ERROR: NO SE PUDO AGREGAR LA MESA" DISPLAY "--------------------------------" DISPLAY WS-ERROR-SQL PERFORM MENU-OPTIONS END-IF DISPLAY "MESA AGREGADA CON ÉXITO" DISPLAY "-----------------------" PERFORM MENU-OPTIONS.
ADD-PEDIDO. 
DISPLAY "AGREGAR PEDIDO". 
DISPLAY "----------------". 
DISPLAY "NÚMERO DE MESA: ". 
ACCEPT WS-NUMERO-MESA. 
DISPLAY "NOMBRE DEL CLIENTE: ". 
ACCEPT WS-NOMBRE-CLIENTE. 
DISPLAY "CANTIDAD DE PLATILLOS: ". 
ACCEPT WS-CANTIDAD-PLATILLOS. 
COMPUTE WS-TOTAL-FACTURA = 0 PERFORM AGREGAR-PLATILLO-AL-PEDIDO UNTIL WS-CANTIDAD-PLATILLOS = 0 STRING "INSERT INTO PEDIDOS (mesa, cliente, total) VALUES (", WS-NUMERO-MESA, ", '", WS-NOMBRE-CLIENTE, "', ", WS-TOTAL-FACTURA, ")" INTO WS-COMANDO-SQL. EXEC SQL CONNECT TO MYSQLDB END-EXEC EXEC SQL EXECUTE IMMEDIATE :WS-COMANDO-SQL END-EXEC IF SQLCODE NOT = 0 DISPLAY "ERROR: NO SE PUDO AGREGAR EL PEDIDO" DISPLAY "----------------------------------" DISPLAY WS-ERROR-SQL PERFORM MENU-OPTIONS END-IF DISPLAY "PEDIDO AGREGADO CON ÉXITO" DISPLAY "--------------------------" PERFORM MENU-OPTIONS.
AGREGAR-PLATO. 
DISPLAY "AGREGAR PLATO". 
DISPLAY "-------------". 
DISPLAY "CATEGORÍA DEL PLATO: " 
DISPLAY "1. DESAYUNOS" 
DISPLAY "2. ENTRADAS" 
DISPLAY "3. ENSALADAS" 
DISPLAY "4. CONTORNOS" 
DISPLAY "5. CARNES" 
DISPLAY "6. PESCADOS Y MARISCOS" 
DISPLAY "7. BEBIDAS" ACCEPT WS-CATEGORIA-PLATILLO 
DISPLAY "NOMBRE DEL PLATO: " ACCEPT WS-NOMBRE-PLATILLO 
DISPLAY "DESCRIP
DISPLAY "NOMBRE DEL PLATO: "
ACCEPT NOMBRE-PLATO
DISPLAY "PRECIO DEL PLATO: "
ACCEPT PRECIO-PLATO
ESCRIBIR-REGISTRO(NOMBRE-PLATO, PRECIO-PLATO)
DISPLAY "PLATO AGREGADO EXITOSAMENTE."
PROCEDURE ESCRIBIR-REGISTRO(NOMBRE-PLATO, PRECIO-PLATO)
  OPEN ARCHIVO-REGISTRO FOR APPEND
  WRITE NOMBRE-PLATO, " ", PRECIO-PLATO TO ARCHIVO-REGISTRO
  CLOSE ARCHIVO-REGISTRO
END PROCEDURE



